<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>osu!mania — Score/Combo (font → PNG)</title>
  <style>
    :root{
      --bg:#0b0c0f;
      --fg:#ececec;
      --muted:rgba(255,255,255,.68);
      --border:rgba(255,255,255,.12);
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.035);
      --shadow:0 18px 60px rgba(0,0,0,.55);
      --r:16px;
      --pad:14px;
      --gap:12px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --btn: rgba(255,255,255,.10);
      --btn2: rgba(255,255,255,.16);
      --good: rgba(80,255,200,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--fg);
      background:
        radial-gradient(1200px 900px at 15% 10%, rgba(120,110,255,.14), transparent 55%),
        radial-gradient(900px 700px at 85% 25%, rgba(0,255,210,.10), transparent 60%),
        var(--bg);
    }
    .wrap{max-width:1240px;margin:0 auto;padding:18px}
    header{display:flex;align-items:flex-end;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:14px}
    h1{margin:0;font-size:18px;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:12.5px;line-height:1.35}
    .grid{
      display:grid;
      grid-template-columns: 460px 1fr;
      gap:14px;
    }
    @media (max-width: 1040px){ .grid{grid-template-columns:1fr} }
    .card{
      border:1px solid var(--border);
      background:linear-gradient(180deg, var(--panel), var(--panel2));
      border-radius:var(--r);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .hd{
      padding:12px 14px;
      border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:space-between;gap:10px;
    }
    .hd b{font-size:13px}
    .bd{padding:14px}
    .row{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    .row3{display:grid;grid-template-columns: 1fr 1fr 1fr;gap:12px}
    .row4{display:grid;grid-template-columns: 1fr 1fr 1fr 1fr;gap:12px}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    input[type="text"], input[type="number"], select{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.28);
      color:var(--fg);
      outline:none;
    }
    input[type="file"]{
      width:100%;
      padding:10px;
      border-radius:12px;
      border:1px dashed var(--border);
      background:rgba(0,0,0,.18);
      color:var(--muted);
    }
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{
      appearance:none;border:1px solid var(--border);
      background:var(--btn);
      color:var(--fg);
      padding:10px 12px;border-radius:999px;
      cursor:pointer;
      font-weight:600;
      transition:transform .08s ease, background .12s ease;
    }
    button:hover{background:var(--btn2)}
    button:active{transform:translateY(1px)}
    .btn-good{background:var(--good)}
    .tiny{font-size:11.5px;color:var(--muted);line-height:1.35;margin-top:8px}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.22);
      color:var(--muted);
      font-size:12px;
      user-select:none;
    }
    .mono{font-family:var(--mono)}
    .divider{height:1px;background:var(--border);margin:12px 0}
    .preview-wrap{display:grid;grid-template-columns: 1fr; gap:12px}
    .preview-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 780px){ .preview-grid{grid-template-columns:1fr} }

    .pv{
      border:1px solid var(--border);
      border-radius:14px;
      background:rgba(0,0,0,.18);
      overflow:hidden;
    }
    .pv .pvh{
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:space-between;gap:8px;
    }
    .pv .pvh .t{font-size:12.5px;font-weight:700}
    .pv .pvh .s{font-size:11.5px;color:var(--muted)}
    .pv .pvb{padding:10px 12px}
    .thumbs{
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap:10px;
    }
    .thumb{
      display:flex;flex-direction:column;gap:6px;align-items:center;
      padding:8px;border-radius:12px;border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
    }
    .thumb canvas{image-rendering:auto;display:block}
    .thumb .cap{font-size:11px;color:var(--muted);font-family:var(--mono)}
    .note{
      padding:10px 12px;border-radius:14px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.18);
      color:var(--muted);
      font-size:12.3px;
      line-height:1.4;
    }
    .status{
      margin-top:10px;
      font-size:12px;color:var(--muted);
    }
    .status b{color:var(--fg)}
    .right-actions{display:flex;gap:8px;flex-wrap:wrap}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>osu!mania — Gerador de Score/Combo (Fonte → PNG)</h1>
        <div class="sub">
          Normal: <span class="mono">44×66 @2x</span> (centralizado) + downscale <span class="mono">22×33</span> •
          Seu estilo: <span class="mono">350×350</span> (canto superior direito, sem cortar)
        </div>
      </div>
      <div class="right-actions">
        <span class="pill">Preview ao lado • exporta PNG</span>
      </div>
    </header>

    <div class="grid">
      <!-- CONTROLES -->
      <section class="card">
        <div class="hd">
          <b>Configurações</b>
          <button id="btnRender" class="btn-good">Gerar / Atualizar preview</button>
        </div>
        <div class="bd">
          <div class="note">
            <b>Como funciona:</b> você escolhe uma fonte para <b>Score</b> e outra para <b>Combo</b>.
            O estilo <b>Normal</b> sempre gera <span class="mono">@2x (44×66)</span> e a versão <span class="mono">1x (22×33)</span>.
            O estilo <b>Meu estilo</b> gera <span class="mono">350×350</span> com o dígito no topo-direita.
          </div>

          <div class="divider"></div>

          <div class="row">
            <div>
              <label>Estilo do Score</label>
              <select id="scoreStyle">
                <option value="normal">Normal (44×66 @2x + downscale)</option>
                <option value="my">Meu estilo (350×350, topo-direita)</option>
              </select>
            </div>
            <div>
              <label>Prefix do Score</label>
              <input id="scorePrefix" type="text" value="score-" />
            </div>
          </div>

          <div class="row" style="margin-top:12px;">
            <div>
              <label>Fonte do Score (.ttf/.otf)</label>
              <input id="scoreFont" type="file" accept=".ttf,.otf" />
              <div class="tiny">Upload local. Nada sai do seu PC (fica tudo no navegador).</div>
            </div>
            <div>
              <label>Tamanho da fonte (Score)</label>
              <input id="scoreSize" type="number" min="1" step="1" value="52" />
              <div class="tiny">Para Normal, isso controla o “zoom” dentro do 44×66.</div>
            </div>
          </div>

          <div class="row3" style="margin-top:12px;">
            <div>
              <label>Cor (Score)</label>
              <input id="scoreColor" type="text" value="#FFFFFF" />
            </div>
            <div>
              <label>Offset X (Score)</label>
              <input id="scoreOffX" type="number" step="1" value="0" />
            </div>
            <div>
              <label>Offset Y (Score)</label>
              <input id="scoreOffY" type="number" step="1" value="0" />
            </div>
          </div>

          <div class="divider"></div>

          <div class="row">
            <div>
              <label>Estilo do Combo</label>
              <select id="comboStyle">
                <option value="normal">Normal (44×66 @2x + downscale)</option>
                <option value="my">Meu estilo (350×350, topo-direita)</option>
              </select>
            </div>
            <div>
              <label>Prefix do Combo</label>
              <input id="comboPrefix" type="text" value="mania-combo-" />
            </div>
          </div>

          <div class="row" style="margin-top:12px;">
            <div>
              <label>Fonte do Combo (.ttf/.otf)</label>
              <input id="comboFont" type="file" accept=".ttf,.otf" />
            </div>
            <div>
              <label>Tamanho da fonte (Combo)</label>
              <input id="comboSize" type="number" min="1" step="1" value="52" />
            </div>
          </div>

          <div class="row3" style="margin-top:12px;">
            <div>
              <label>Cor (Combo)</label>
              <input id="comboColor" type="text" value="#FFFFFF" />
            </div>
            <div>
              <label>Offset X (Combo)</label>
              <input id="comboOffX" type="number" step="1" value="0" />
            </div>
            <div>
              <label>Offset Y (Combo)</label>
              <input id="comboOffY" type="number" step="1" value="0" />
            </div>
          </div>

          <div class="divider"></div>

          <div class="row4">
            <div>
              <label>Padding topo-direita (Meu estilo)</label>
              <input id="myPad" type="number" min="0" step="1" value="6" />
            </div>
            <div>
              <label>Canvas “Meu estilo”</label>
              <input id="mySize" type="number" min="1" step="1" value="350" />
            </div>
            <div>
              <label>Normal @2x (L×A)</label>
              <input id="nW" type="number" min="1" step="1" value="44" />
            </div>
            <div>
              <label>Normal @2x (A)</label>
              <input id="nH" type="number" min="1" step="1" value="66" />
            </div>
          </div>

          <div class="btns">
            <button id="btnDlScore2x">Baixar Score @2x (0–9)</button>
            <button id="btnDlScore1x">Baixar Score 1x (0–9)</button>
            <button id="btnDlCombo2x">Baixar Combo @2x (0–9)</button>
            <button id="btnDlCombo1x">Baixar Combo 1x (0–9)</button>
            <button id="btnDlMy">Baixar “Meu estilo” (Score + Combo)</button>
          </div>

          <div class="status" id="status">Status: <b>pronto</b>.</div>
          <div class="tiny">
            Nomes gerados:<br/>
            <span class="mono">Normal:</span> <span class="mono">{prefix}{n}@2x.png</span> e <span class="mono">{prefix}{n}.png</span><br/>
            <span class="mono">Meu estilo:</span> <span class="mono">{prefix}{n}.png</span> (350×350)
          </div>
        </div>
      </section>

      <!-- PREVIEW -->
      <section class="card">
        <div class="hd">
          <b>Preview</b>
          <span class="pill mono">0–9</span>
        </div>
        <div class="bd">
          <div class="preview-wrap">
            <div class="preview-grid">
              <div class="pv">
                <div class="pvh">
                  <div>
                    <div class="t">Score — @2x</div>
                    <div class="s mono" id="pvScore2xInfo">44×66</div>
                  </div>
                  <div class="s" id="pvScoreStyleTag">Normal</div>
                </div>
                <div class="pvb"><div class="thumbs" id="pvScore2x"></div></div>
              </div>

              <div class="pv">
                <div class="pvh">
                  <div>
                    <div class="t">Score — 1x</div>
                    <div class="s mono" id="pvScore1xInfo">22×33</div>
                  </div>
                  <div class="s">Downscale</div>
                </div>
                <div class="pvb"><div class="thumbs" id="pvScore1x"></div></div>
              </div>

              <div class="pv">
                <div class="pvh">
                  <div>
                    <div class="t">Combo — @2x</div>
                    <div class="s mono" id="pvCombo2xInfo">44×66</div>
                  </div>
                  <div class="s" id="pvComboStyleTag">Normal</div>
                </div>
                <div class="pvb"><div class="thumbs" id="pvCombo2x"></div></div>
              </div>

              <div class="pv">
                <div class="pvh">
                  <div>
                    <div class="t">Combo — 1x</div>
                    <div class="s mono" id="pvCombo1xInfo">22×33</div>
                  </div>
                  <div class="s">Downscale</div>
                </div>
                <div class="pvb"><div class="thumbs" id="pvCombo1x"></div></div>
              </div>
            </div>

            <div class="pv">
              <div class="pvh">
                <div>
                  <div class="t">Meu estilo (350×350 topo-direita)</div>
                  <div class="s mono" id="pvMyInfo">350×350</div>
                </div>
                <div class="s">Score + Combo</div>
              </div>
              <div class="pvb">
                <div class="thumbs" id="pvMy"></div>
              </div>
            </div>

            <div class="note">
              Dica nerd: a renderização do Canvas varia um pouco entre navegadores.
              Se você for extremamente exigente com kerning/posicionamento, use os offsets e o tamanho da fonte até “encaixar” do seu jeito.
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

<script>
(() => {
  const $ = (id) => document.getElementById(id);

  const digits = [...Array(10)].map((_,i)=>String(i));

  // UI
  const el = {
    scoreStyle: $('scoreStyle'),
    scorePrefix: $('scorePrefix'),
    scoreFont: $('scoreFont'),
    scoreSize: $('scoreSize'),
    scoreColor: $('scoreColor'),
    scoreOffX: $('scoreOffX'),
    scoreOffY: $('scoreOffY'),

    comboStyle: $('comboStyle'),
    comboPrefix: $('comboPrefix'),
    comboFont: $('comboFont'),
    comboSize: $('comboSize'),
    comboColor: $('comboColor'),
    comboOffX: $('comboOffX'),
    comboOffY: $('comboOffY'),

    myPad: $('myPad'),
    mySize: $('mySize'),
    nW: $('nW'),
    nH: $('nH'),

    btnRender: $('btnRender'),
    btnDlScore2x: $('btnDlScore2x'),
    btnDlScore1x: $('btnDlScore1x'),
    btnDlCombo2x: $('btnDlCombo2x'),
    btnDlCombo1x: $('btnDlCombo1x'),
    btnDlMy: $('btnDlMy'),

    status: $('status'),

    pvScore2x: $('pvScore2x'),
    pvScore1x: $('pvScore1x'),
    pvCombo2x: $('pvCombo2x'),
    pvCombo1x: $('pvCombo1x'),
    pvMy: $('pvMy'),

    pvScore2xInfo: $('pvScore2xInfo'),
    pvScore1xInfo: $('pvScore1xInfo'),
    pvCombo2xInfo: $('pvCombo2xInfo'),
    pvCombo1xInfo: $('pvCombo1xInfo'),
    pvMyInfo: $('pvMyInfo'),
    pvScoreStyleTag: $('pvScoreStyleTag'),
    pvComboStyleTag: $('pvComboStyleTag'),
  };

  let fontFamilyScore = null;
  let fontFamilyCombo = null;

  function setStatus(text){
    el.status.innerHTML = `Status: <b>${text}</b>.`;
  }

  function sanitizePrefix(p){
    // só pra evitar prefix esquisito (não remove hífen etc.)
    return (p || '').trim();
  }

  async function loadFontFromFile(file, familyBase){
    if(!file) return null;
    const ab = await file.arrayBuffer();
    const blob = new Blob([ab], {type: "font/ttf"});
    const url = URL.createObjectURL(blob);
    const family = `${familyBase}-${Math.random().toString(16).slice(2)}`;
    const ff = new FontFace(family, `url(${url})`);
    await ff.load();
    document.fonts.add(ff);
    return family;
  }

  function makeCanvas(w,h){
    const c = document.createElement('canvas');
    c.width = w; c.height = h;
    return c;
  }

  function clear(ctx,w,h){
    ctx.clearRect(0,0,w,h);
  }

  function drawCenteredText(ctx, text, w, h, family, size, color, offX, offY){
    ctx.save();
    ctx.font = `${size}px "${family}", sans-serif`;
    ctx.fillStyle = color;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.imageSmoothingEnabled = true;
    ctx.fillText(text, w/2 + offX, h/2 + offY);
    ctx.restore();
  }

  function drawTopRightText(ctx, text, w, h, family, size, color, pad, offX, offY){
    ctx.save();
    ctx.font = `${size}px "${family}", sans-serif`;
    ctx.fillStyle = color;
    ctx.textAlign = 'left';
    ctx.textBaseline = 'alphabetic';
    ctx.imageSmoothingEnabled = true;

    // Medidas reais do glifo
    const m = ctx.measureText(text);
    const ascent = m.actualBoundingBoxAscent || size*0.8;
    const descent = m.actualBoundingBoxDescent || size*0.2;
    const tw = m.width;
    const th = ascent + descent;

    // canto superior direito "lá no final", mas sem cortar:
    // x: encosta na direita -> w - pad - largura
    // y: encosta no topo -> pad + ascent (porque baseline)
    let x = (w - pad - tw) + offX;
    let y = (pad + ascent) + offY;

    // clamp de segurança (não deixa sair)
    x = Math.max(0, Math.min(x, w - tw));
    y = Math.max(ascent, Math.min(y, h - descent));

    ctx.fillText(text, x, y);
    ctx.restore();
  }

  function downscaleCanvas(srcCanvas, targetW, targetH){
    const out = makeCanvas(targetW, targetH);
    const octx = out.getContext('2d');
    octx.imageSmoothingEnabled = true;
    octx.clearRect(0,0,targetW,targetH);
    octx.drawImage(srcCanvas, 0, 0, targetW, targetH);
    return out;
  }

  function canvasToBlob(canvas){
    return new Promise((resolve) => canvas.toBlob(resolve, 'image/png'));
  }

  function downloadBlob(blob, filename){
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 1500);
  }

  function renderSet({style, prefix, family, size, color, offX, offY, nW, nH, mySize, myPad}){
    const pref = sanitizePrefix(prefix);
    const isNormal = style === 'normal';

    const result = {
      // maps: name -> canvas
      score2x: new Map(),
      score1x: new Map(),
      my: new Map(),
      meta: {pref, style}
    };

    for(const d of digits){
      if(isNormal){
        const c2x = makeCanvas(nW, nH);
        const ctx = c2x.getContext('2d');
        clear(ctx,nW,nH);
        drawCenteredText(ctx, d, nW, nH, family, size, color, offX, offY);

        const c1x = downscaleCanvas(c2x, Math.round(nW/2), Math.round(nH/2));

        result.score2x.set(`${pref}${d}@2x.png`, c2x);
        result.score1x.set(`${pref}${d}.png`, c1x);
      }else{
        const S = mySize;
        const c = makeCanvas(S, S);
        const ctx = c.getContext('2d');
        clear(ctx,S,S);
        drawTopRightText(ctx, d, S, S, family, size, color, myPad, offX, offY);
        result.my.set(`${pref}${d}.png`, c);
      }
    }

    return result;
  }

  function fillPreview(container, map, max = 10){
    container.innerHTML = '';
    const entries = [...map.entries()].slice(0, max);
    for(const [name, canvas] of entries){
      const box = document.createElement('div');
      box.className = 'thumb';

      const c = makeCanvas(canvas.width, canvas.height);
      const ctx = c.getContext('2d');
      ctx.imageSmoothingEnabled = true;
      ctx.clearRect(0,0,c.width,c.height);
      ctx.drawImage(canvas,0,0);

      box.appendChild(c);
      const cap = document.createElement('div');
      cap.className = 'cap';
      cap.textContent = name.replace(/^.*?(\d.*)/, '$1'); // mostra só parte final mais curta
      box.appendChild(cap);

      container.appendChild(box);
    }
  }

  // Estado atual renderizado
  let rendered = {
    score: null,
    combo: null,
    my: null,
  };

  async function ensureFontsLoaded(){
    setStatus('carregando fontes');

    const sfile = el.scoreFont.files?.[0] || null;
    const cfile = el.comboFont.files?.[0] || null;

    // Se não escolher fonte, ainda deixa gerar com fallback (mas avisamos)
    if(sfile){
      fontFamilyScore = await loadFontFromFile(sfile, 'ScoreFont');
    }else{
      fontFamilyScore = 'sans-serif';
    }

    if(cfile){
      fontFamilyCombo = await loadFontFromFile(cfile, 'ComboFont');
    }else{
      fontFamilyCombo = 'sans-serif';
    }

    setStatus('fontes prontas');
  }

  async function renderAll(){
    try{
      await ensureFontsLoaded();

      const nW = Math.max(1, parseInt(el.nW.value||'44',10));
      const nH = Math.max(1, parseInt(el.nH.value||'66',10));
      const mySize = Math.max(1, parseInt(el.mySize.value||'350',10));
      const myPad = Math.max(0, parseInt(el.myPad.value||'6',10));

      // SCORE
      const scoreStyle = el.scoreStyle.value;
      const score = renderSet({
        style: scoreStyle,
        prefix: el.scorePrefix.value,
        family: fontFamilyScore,
        size: parseInt(el.scoreSize.value||'52',10),
        color: (el.scoreColor.value||'#fff').trim(),
        offX: parseInt(el.scoreOffX.value||'0',10),
        offY: parseInt(el.scoreOffY.value||'0',10),
        nW, nH, mySize, myPad
      });

      // COMBO
      const comboStyle = el.comboStyle.value;
      const combo = renderSet({
        style: comboStyle,
        prefix: el.comboPrefix.value,
        family: fontFamilyCombo,
        size: parseInt(el.comboSize.value||'52',10),
        color: (el.comboColor.value||'#fff').trim(),
        offX: parseInt(el.comboOffX.value||'0',10),
        offY: parseInt(el.comboOffY.value||'0',10),
        nW, nH, mySize, myPad
      });

      rendered.score = score;
      rendered.combo = combo;

      // Preview info
      el.pvScore2xInfo.textContent = `${nW}×${nH}`;
      el.pvScore1xInfo.textContent = `${Math.round(nW/2)}×${Math.round(nH/2)}`;
      el.pvCombo2xInfo.textContent = `${nW}×${nH}`;
      el.pvCombo1xInfo.textContent = `${Math.round(nW/2)}×${Math.round(nH/2)}`;
      el.pvMyInfo.textContent = `${mySize}×${mySize}`;

      el.pvScoreStyleTag.textContent = (scoreStyle === 'normal') ? 'Normal' : 'Meu estilo';
      el.pvComboStyleTag.textContent = (comboStyle === 'normal') ? 'Normal' : 'Meu estilo';

      // Fill previews
      // Score
      fillPreview(el.pvScore2x, score.score2x, 10);
      fillPreview(el.pvScore1x, score.score1x, 10);

      // Combo
      fillPreview(el.pvCombo2x, combo.score2x, 10);
      fillPreview(el.pvCombo1x, combo.score1x, 10);

      // Meu estilo (mostra score + combo juntos numa lista)
      el.pvMy.innerHTML = '';
      const myEntries = [];
      for(const [n,c] of score.my.entries()) myEntries.push([`S:${n}`, c]);
      for(const [n,c] of combo.my.entries()) myEntries.push([`C:${n}`, c]);

      for(const [tag, canvas] of myEntries.slice(0,10)){
        const box = document.createElement('div');
        box.className = 'thumb';
        const c = makeCanvas(canvas.width, canvas.height);
        c.getContext('2d').drawImage(canvas,0,0);
        box.appendChild(c);
        const cap = document.createElement('div');
        cap.className = 'cap';
        cap.textContent = tag;
        box.appendChild(cap);
        el.pvMy.appendChild(box);
      }

      setStatus('preview atualizado');
    }catch(err){
      console.error(err);
      setStatus('erro (veja o console)');
    }
  }

  async function downloadMap(map){
    for(const [name, canvas] of map.entries()){
      const blob = await canvasToBlob(canvas);
      downloadBlob(blob, name);
      // micro-pausa pra não engasgar o navegador com 10 downloads instantâneos
      await new Promise(r=>setTimeout(r, 80));
    }
  }

  // Downloads
  el.btnDlScore2x.addEventListener('click', async () => {
    if(!rendered.score) await renderAll();
    const style = el.scoreStyle.value;
    if(style !== 'normal'){
      setStatus('Score não está no estilo Normal (@2x)');
      return;
    }
    setStatus('baixando score @2x');
    await downloadMap(rendered.score.score2x);
    setStatus('feito');
  });

  el.btnDlScore1x.addEventListener('click', async () => {
    if(!rendered.score) await renderAll();
    const style = el.scoreStyle.value;
    if(style !== 'normal'){
      setStatus('Score não está no estilo Normal (1x)');
      return;
    }
    setStatus('baixando score 1x');
    await downloadMap(rendered.score.score1x);
    setStatus('feito');
  });

  el.btnDlCombo2x.addEventListener('click', async () => {
    if(!rendered.combo) await renderAll();
    const style = el.comboStyle.value;
    if(style !== 'normal'){
      setStatus('Combo não está no estilo Normal (@2x)');
      return;
    }
    setStatus('baixando combo @2x');
    await downloadMap(rendered.combo.score2x);
    setStatus('feito');
  });

  el.btnDlCombo1x.addEventListener('click', async () => {
    if(!rendered.combo) await renderAll();
    const style = el.comboStyle.value;
    if(style !== 'normal'){
      setStatus('Combo não está no estilo Normal (1x)');
      return;
    }
    setStatus('baixando combo 1x');
    await downloadMap(rendered.combo.score1x);
    setStatus('feito');
  });

  el.btnDlMy.addEventListener('click', async () => {
    if(!rendered.score || !rendered.combo) await renderAll();
    setStatus('baixando meu estilo');

    // baixa o que estiver no estilo "my" (para score e combo)
    const scoreStyle = el.scoreStyle.value;
    const comboStyle = el.comboStyle.value;

    if(scoreStyle === 'my'){
      await downloadMap(rendered.score.my);
    }
    if(comboStyle === 'my'){
      await downloadMap(rendered.combo.my);
    }

    if(scoreStyle !== 'my' && comboStyle !== 'my'){
      setStatus('nenhum dos dois está em “Meu estilo”');
      return;
    }

    setStatus('feito');
  });

  el.btnRender.addEventListener('click', renderAll);

  // auto render inicial
  renderAll();
})();
</script>
</body>
</html>
